<!DOCTYPE html>
<html>
<head>
    <title>Astral Keys Monitor - Settings & Logs</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 24px;
        }
        
        .content {
            display: flex;
            min-height: 500px;
        }
        
        .sidebar {
            width: 300px;
            background: #f8f9fa;
            padding: 20px;
            border-right: 1px solid #dee2e6;
        }
        
        .main-content {
            flex: 1;
            padding: 20px;
        }
        
        .section {
            margin-bottom: 30px;
        }
        
        .section h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        
        .setting-group {
            margin-bottom: 20px;
        }
        
        .setting-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .setting-group input[type="checkbox"] {
            margin-right: 10px;
        }
        
        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .btn:hover {
            background: #2980b9;
        }
        
        .btn-danger {
            background: #e74c3c;
        }
        
        .btn-danger:hover {
            background: #c0392b;
        }
        
        .btn-success {
            background: #27ae60;
        }
        
        .btn-success:hover {
            background: #229954;
        }
        
        .logs-container {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        
        .log-entry {
            margin-bottom: 5px;
            padding: 2px 0;
        }
        
        .log-info {
            color: #3498db;
        }
        
        .log-error {
            color: #e74c3c;
        }
        
        .log-warning {
            color: #f39c12;
        }
        
        .log-success {
            color: #27ae60;
        }
        
        .stats {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: #ecf0f1;
            padding: 15px;
            border-radius: 4px;
            text-align: center;
            flex: 1;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .stat-label {
            font-size: 12px;
            color: #7f8c8d;
            text-transform: uppercase;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #dee2e6;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }
        
        .tab.active {
            border-bottom-color: #3498db;
            color: #3498db;
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Astral Keys Monitor - Settings & Logs</h1>
        </div>
        
        <div class="content">
            <div class="sidebar">
                <div class="section">
                    <h2>Settings</h2>
                    
                    <div class="setting-group">
                        <label>
                            <input type="checkbox" id="autoStart">
                            Auto-start on Windows boot
                        </label>
                    </div>
                    
                    <div class="setting-group">
                        <label>
                            <input type="checkbox" id="startHidden">
                            Start hidden in system tray
                        </label>
                    </div>
                    
                    <div class="setting-group">
                        <button class="btn btn-success" id="exportToSheets">Export to Google Sheets</button>
                    </div>
                    
                    <div class="setting-group">
                        <button class="btn" id="refreshData">Refresh Data</button>
                    </div>
                </div>
                
                <div class="section">
                    <h2>Logs</h2>
                    
                    <div class="stats">
                        <div class="stat-card">
                            <div class="stat-number" id="logCount">0</div>
                            <div class="stat-label">Total Logs</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="maxLogs">1000</div>
                            <div class="stat-label">Max Logs</div>
                        </div>
                    </div>
                    
                    <button class="btn" id="refreshLogs">Refresh Logs</button>
                    <button class="btn btn-danger" id="clearLogs">Clear Logs</button>
                </div>
            </div>
            
            <div class="main-content">
                <div class="tabs">
                    <div class="tab active" data-tab="logs">Application Logs</div>
                    <div class="tab" data-tab="info">Information</div>
                </div>
                
                <div class="tab-content active" id="logs-tab">
                    <div class="logs-container" id="logsContainer">
                        Loading logs...
                    </div>
                </div>
                
                <div class="tab-content" id="info-tab">
                    <div class="section">
                        <h2>Application Information</h2>
                        <p><strong>Version:</strong> 1.0.0</p>
                        <p><strong>Platform:</strong> <span id="platform"></span></p>
                        <p><strong>Node.js Version:</strong> <span id="nodeVersion"></span></p>
                        <p><strong>Electron Version:</strong> <span id="electronVersion"></span></p>
                    </div>
                    
                    <div class="section">
                        <h2>Features</h2>
                        <ul>
                            <li>Automatic file monitoring</li>
                            <li>Google Sheets integration</li>
                            <li>System tray support</li>
                            <li>Auto-start on Windows boot</li>
                            <li>Start hidden in system tray</li>
                            <li>Multi-user support</li>
                            <li>Real-time logging</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        const { ipcRenderer } = require('electron')
        
        // Initialize settings
        async function initializeSettings() {
            try {
                const autoStart = await ipcRenderer.invoke('get-auto-start-status')
                const startHidden = await ipcRenderer.invoke('get-start-hidden')
                
                document.getElementById('autoStart').checked = autoStart
                document.getElementById('startHidden').checked = startHidden
                
                // Set platform info
                document.getElementById('platform').textContent = process.platform
                document.getElementById('nodeVersion').textContent = process.versions.node
                document.getElementById('electronVersion').textContent = process.versions.electron
            } catch (error) {
                console.error('Error initializing settings:', error)
            }
        }
        
        // Load and display logs
        async function loadLogs() {
            try {
                const logs = await ipcRenderer.invoke('get-logs')
                const settings = await ipcRenderer.invoke('get-log-settings')
                
                document.getElementById('logCount').textContent = settings.currentLogCount
                document.getElementById('maxLogs').textContent = settings.maxLogs
                
                const logsContainer = document.getElementById('logsContainer')
                logsContainer.innerHTML = ''
                
                if (logs.length === 0) {
                    logsContainer.innerHTML = 'No logs available'
                    return
                }
                
                logs.forEach(log => {
                    const logEntry = document.createElement('div')
                    logEntry.className = `log-entry log-${log.type}`
                    logEntry.textContent = `[${new Date(log.timestamp).toLocaleString()}] [${log.type.toUpperCase()}] ${log.message}`
                    logsContainer.appendChild(logEntry)
                })
            } catch (error) {
                console.error('Error loading logs:', error)
                document.getElementById('logsContainer').innerHTML = 'Error loading logs: ' + error.message
            }
        }
        
        // Event listeners
        document.getElementById('autoStart').addEventListener('change', async (e) => {
            await ipcRenderer.invoke('set-auto-start', e.target.checked)
        })
        
        document.getElementById('startHidden').addEventListener('change', async (e) => {
            await ipcRenderer.invoke('set-start-hidden', e.target.checked)
        })
        
        document.getElementById('exportToSheets').addEventListener('click', async () => {
            try {
                document.getElementById('exportToSheets').disabled = true
                document.getElementById('exportToSheets').textContent = 'Exporting...'
                
                await ipcRenderer.invoke('export-to-sheets')
                alert('Successfully exported to Google Sheets!')
            } catch (error) {
                alert('Error exporting to Google Sheets: ' + error.message)
            } finally {
                document.getElementById('exportToSheets').disabled = false
                document.getElementById('exportToSheets').textContent = 'Export to Google Sheets'
            }
        })
        
        document.getElementById('refreshData').addEventListener('click', async () => {
            try {
                document.getElementById('refreshData').disabled = true
                document.getElementById('refreshData').textContent = 'Refreshing...'
                
                await ipcRenderer.invoke('refresh-data')
                alert('Data refreshed successfully!')
            } catch (error) {
                alert('Error refreshing data: ' + error.message)
            } finally {
                document.getElementById('refreshData').disabled = false
                document.getElementById('refreshData').textContent = 'Refresh Data'
            }
        })
        
        document.getElementById('refreshLogs').addEventListener('click', loadLogs)
        
        document.getElementById('clearLogs').addEventListener('click', async () => {
            if (confirm('Are you sure you want to clear all logs?')) {
                await ipcRenderer.invoke('clear-logs')
                loadLogs()
            }
        })
        
        // Tab functionality
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // Remove active class from all tabs and content
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'))
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'))
                
                // Add active class to clicked tab and corresponding content
                tab.classList.add('active')
                const tabId = tab.getAttribute('data-tab')
                document.getElementById(tabId + '-tab').classList.add('active')
            })
        })
        
        // Auto-refresh logs every 5 seconds
        setInterval(loadLogs, 5000)
        
        // Initialize
        initializeSettings()
        loadLogs()
    </script>
</body>
</html> 